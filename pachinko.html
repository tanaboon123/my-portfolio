<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡πÄ‡∏Å‡∏°‡∏õ‡∏≤‡∏à‡∏¥‡∏á‡πÇ‡∏Å‡∏∞ ‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f9f6f0;
      text-align: center;
      user-select: none;
    }
    h1 {
      color: #d35400;
      margin: 20px 0;
    }

    #game-container {
      position: relative;
      width: 320px;
      height: 500px;
      margin: 0 auto;
      background: linear-gradient(180deg, #f3e5ab 0%, #b48b3b 100%);
      border: 4px solid #8b5e00;
      border-radius: 20px;
      box-shadow: inset 0 0 10px #d2b36f;
      overflow: hidden;
    }

    /* ‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ö‡∏≠‡∏• (‡∏£‡πà‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ö‡∏≠‡∏•) */
    #catch-slot {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 20px;
      background: #c2b280;
      border-radius: 15px / 10px;
      box-shadow: inset 0 0 8px #8b7b52;
      border: 2px solid #7a6e3e;
      z-index: 20;
    }

    /* ‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏∏‡∏ô - Spinner */
    #spinner {
      position: absolute;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      width: 160px;
      height: 160px;
      background: radial-gradient(circle at center, #bfaf8f 0%, #7e6d44 100%);
      border-radius: 50%;
      box-shadow:
        inset 0 0 10px #a79d75,
        0 4px 8px rgba(0,0,0,0.4);
      cursor: grab;
      user-select: none;
      transition: box-shadow 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #spinner:active {
      cursor: grabbing;
      box-shadow:
        inset 0 0 15px #a79d75,
        0 0 25px 5px #d4c67a;
    }

    /* ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏™‡∏µ‡πÄ‡∏á‡∏¥‡∏ô */
    .ball {
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: radial-gradient(circle at 7px 7px, #c0c0c0, #7f7f7f);
      border: 1.5px solid #4f4f4f;
      box-shadow:
        inset 1px 1px 3px rgba(255,255,255,0.9),
        0 1px 3px rgba(0,0,0,0.3);
      z-index: 30;
      pointer-events: none;
    }

    /* ‡∏™‡∏•‡πá‡∏≠‡∏ï 3 ‡∏ä‡πà‡∏≠‡∏á */
    #slot-machine {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 100px;
      background: #eedc82;
      border-radius: 12px;
      border: 3px solid #b28f3b;
      box-shadow: inset 0 0 10px #fff8d3;
      display: flex;
      justify-content: space-around;
      align-items: center;
      font-size: 48px;
      font-weight: 900;
      color: #7a5a01;
      user-select: none;
      letter-spacing: 10px;
      font-family: 'Courier New', Courier, monospace;
      z-index: 15;
    }

    /* ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
    #scoreboard {
      margin-top: 15px;
      font-size: 20px;
      color: #6e4a00;
    }

    button#drop-btn {
      margin-top: 25px;
      padding: 12px 28px;
      font-size: 20px;
      background-color: #cfa02a;
      border: none;
      border-radius: 10px;
      color: white;
      font-weight: 700;
      box-shadow: 0 3px 6px #a17e0c;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button#drop-btn:hover:not(:disabled) {
      background-color: #e0b71a;
    }
    button#drop-btn:disabled {
      background-color: #aaa;
      cursor: default;
    }
  </style>
</head>
<body>
  <h1>üé∞ ‡πÄ‡∏Å‡∏°‡∏õ‡∏≤‡∏à‡∏¥‡∏á‡πÇ‡∏Å‡∏∞ ‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á TT2 üéâ</h1>

  <div id="game-container">
    <div id="catch-slot"></div>

    <div id="slot-machine">- - -</div>

    <div id="spinner" title="‡∏´‡∏°‡∏∏‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏∏‡∏ô‡∏ô‡∏µ‡πâ (‡∏•‡∏≤‡∏Å‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏£‡∏á)"></div>
  </div>

  <button id="drop-btn" disabled>‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•</button>

  <div id="scoreboard">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: <span id="high-score">0</span></div>

  <script>
    const gameContainer = document.getElementById('game-container');
    const catchSlot = document.getElementById('catch-slot');
    const slotMachine = document.getElementById('slot-machine');
    const spinner = document.getElementById('spinner');
    const dropBtn = document.getElementById('drop-btn');
    const highScoreSpan = document.getElementById('high-score');

    let ball = null;
    let ballY = 0;
    let ballVelocity = 0;
    let gravity = 0.4;
    let spinForce = 0;
    let isBallActive = false;
    let animationId = null;
    let spinRotation = 0;

    let scores = [0, 0, 0];
    let highScore = Number(localStorage.getItem('pachinkoHighScore') || 0);
    highScoreSpan.textContent = highScore;

    // ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏Å‡πá‡∏ï‡πà‡∏≠‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏û‡∏≠
    function checkDropEnable() {
      dropBtn.disabled = spinForce < 5;
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏°‡∏∏‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏•‡∏≤‡∏Å‡πÄ‡∏°‡∏≤‡∏™‡πå
    (function setupSpinnerDrag() {
      let isDragging = false;
      let lastAngle = 0;
      let lastTime = 0;
      let angularVelocity = 0;

      function getAngle(x, y) {
        const rect = spinner.getBoundingClientRect();
        const cx = rect.left + rect.width/2;
        const cy = rect.top + rect.height/2;
        return Math.atan2(y - cy, x - cx) * (180/Math.PI);
      }

      spinner.addEventListener('mousedown', e => {
        isDragging = true;
        lastAngle = getAngle(e.clientX, e.clientY);
        lastTime = performance.now();
        angularVelocity = 0;
        spinForce = 0;
        checkDropEnable();
      });

      window.addEventListener('mousemove', e => {
        if (!isDragging) return;
        const angle = getAngle(e.clientX, e.clientY);
        const now = performance.now();
        let deltaAngle = angle - lastAngle;
        // ‡∏õ‡∏£‡∏±‡∏ö deltaAngle ‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á -180 ‡∏ñ‡∏∂‡∏á 180
        if(deltaAngle > 180) deltaAngle -= 360;
        if(deltaAngle < -180) deltaAngle += 360;

        const deltaTime = now - lastTime;
        angularVelocity = deltaAngle / deltaTime * 16; // normalized

        spinRotation += deltaAngle;
        spinner.style.transform = `translateX(-50%) rotate(${spinRotation}deg)`;

        spinForce = Math.min(Math.abs(angularVelocity) * 30, 50);
        lastAngle = angle;
        lastTime = now;

        checkDropEnable();
      });

      window.addEventListener('mouseup', e => {
        if (isDragging) {
          isDragging = false;
          // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏°‡∏≤‡∏Å‡∏û‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
          if (spinForce >= 5) {
            dropBall();
          }
        }
      });
    })();

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏£‡∏á‡∏´‡∏°‡∏∏‡∏ô
    function dropBall() {
      if (isBallActive) return; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏´‡∏•‡∏≤‡∏¢‡∏•‡∏π‡∏Å‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
      isBallActive = true;
      dropBtn.disabled = true;

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•
      ball = document.createElement('div');
      ball.classList.add('ball');
      ball.style.left = 'calc(50% - 10px)'; // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á
      ballY = gameContainer.clientHeight - 80; // ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏õ‡∏•‡πà‡∏≠‡∏¢‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏• (‡∏ö‡∏ô spinner)
      ball.style.top = ballY + 'px';

      gameContainer.appendChild(ball);

      // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏°‡πÅ‡∏£‡∏á‡∏´‡∏°‡∏∏‡∏ô (spinForce)
      ballVelocity = -spinForce / 2;

      animateBall();
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏• ‡πÅ‡∏•‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡∏≤‡∏£‡∏ï‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á

